<template>
    <div class="app-container">
        <header>
            <h1>Practies Q&A</h1>
        </header>
        <template if:true={showCategoryPage}>
            <div class="category-grid">
                <template for:each={categories} for:item="category">
                    <div key={category.name} data-name={category.name} onclick={handleTabClick} class={category.cardClass}>
                        <div class="card-left" aria-hidden="true"></div>
                        <div class="card-right">
                            <h2 class="card-title">{category.name}</h2>
                            <p class="card-desc">Practice questions and flashcards for {category.name}.</p>
                        </div>
                    </div>
                </template>
            </div>
        </template>

        <template if:false={showCategoryPage}>
            <div class="category-page">
                <button class="back" onclick={backToHome} aria-label="Back to categories">‚Üê Back</button>
                <h2 class="page-title">{selectedCategory.name}</h2>
                <div class="question-list">
                    <template for:each={pagedQuestions} for:item="q">
                        <div key={q.question} class="card">
                            <div class="question">
                                <p><strong>Question {q.number} :</strong> {q.question}</p>
                                <template if:true={q.optionItems}>
                                    <div class="options">
                                        <template for:each={q.optionItems} for:item="item">
                                            <label key={item.key} class={item.class}>
                                                <input type="checkbox" data-question={q.question} data-option={item.key} onchange={handleOptionChange} checked={item.selected} disabled={q.isSubmitted}>
                                                {item.key}. {item.value}
                                            </label>
                                        </template>
                                    </div>
                                </template>
                            </div>
                            <div class="answer">
                                <template if:true={q.reveal}>
                                    <p><strong>Answer :</strong> {q.answer}</p>
                                    <template if:true={q.explanation}>
                                        <p><strong>Explanation :</strong> {q.explanation}</p>
                                    </template>
                                </template>
                            </div>
                            <button class="submit-btn" data-question={q.question} onclick={handleSubmit} disabled={q.isSubmitted}>
                                Submit
                            </button>
                            <button class="toggle-answer" data-question={q.question} onclick={toggleAnswer}>
                                {q.revealLabel}
                            </button>
                            <template if:true={q.isSubmitted}>
                                <p class="feedback">{q.feedback}</p>
                            </template>
                        </div>
                    </template>
                </div>

                <div class="pager">
                    <button class="pager-btn" onclick={prevPage} disabled={isFirstPage}>Previous</button>
                    <span class="pager-info">Page {currentPage} of {totalPages}</span>
                    <button class="pager-btn" onclick={nextPage} disabled={isLastPage}>Next</button>
                </div>
            </div>
        </template>
    </div>
</template>
